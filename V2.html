<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>حاسبة سعرات القط</title>
<style>
  :root{
    --bg1:#0b1324;
    --bg2:#0f1a33;
    --card:#101a30;
    --border:#22314f;
    --text:#e8f0ff;
    --muted:#a9b5d6;
    --accent1:#8a5cff;
    --accent2:#21c3d6;
    --danger:#ff5c7a;
    --success:#4cd964;
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;}
  body{
    margin:0;
    color:var(--text);
    font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans Arabic", "Geeza Pro", sans-serif;
    line-height:1.6;
    /* full-bleed layered background to avoid pale edges */
    min-height:100svh;
    background:
      radial-gradient(1200px 600px at 90% -10%, #4a2cf733, transparent 60%),
      radial-gradient(900px 600px at -10% 0%, #21c3d622, transparent 55%),
      linear-gradient(180deg, var(--bg2), var(--bg1));
    background-attachment: fixed, fixed, fixed;
  }
  .wrap{
    max-width: 820px;
    margin: clamp(12px, 2.5vw, 28px) auto;
    padding: 0 14px 28px;
  }
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding: 14px 18px; border:1px solid var(--border); border-radius: var(--radius);
    background: linear-gradient(180deg, #0f1c36cc, #0c162dcc);
    backdrop-filter: blur(8px);
    position:sticky; top:8px; z-index:5;
  }
  .title{font-weight:800; letter-spacing:.3px; font-size: clamp(18px, 2.4vw, 24px);}
  .lang-toggle{
    display:flex; gap:6px; align-items:center; background:#0c1730; padding:4px; border-radius:999px; border:1px solid var(--border);
  }
  .lang-toggle button{
    min-width:44px; padding:6px 10px; border:none; border-radius:999px; cursor:pointer; font-weight:700; color:var(--muted);
    background:transparent;
  }
  .lang-toggle button.active{
    color:white; background: linear-gradient(90deg, var(--accent1), var(--accent2));
  }
  .card{
    margin-top:16px; padding:18px; border:1px solid var(--border); border-radius: var(--radius);
    background: #0f1a34cc;
  }
  h2{margin:0 0 12px; font-size: clamp(18px,2.2vw,22px);}
  label{display:block; font-weight:700; margin:8px 0 6px; color:var(--muted);}
  select, input[type="number"], input[type="text"]{
    width:100%; padding:14px 12px; background:#0b152d; color:var(--text); border:1px solid var(--border);
    border-radius:12px; outline:none; font-size:16px;
  }
  .row{display:grid; grid-template-columns:1fr; gap:14px;}
  @media(min-width:640px){ .row{grid-template-columns:1fr 1fr;} }
  .chips{display:flex; gap:10px; flex-wrap:wrap; margin-top:6px;}
  .chip{
    display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; border:1px dashed var(--border);
    background:#0b162dcc; cursor:pointer; user-select:none;
  }
  .chip input{accent-color:var(--accent2); width:18px; height:18px;}
  .btns{display:flex; gap:12px; flex-wrap:wrap; margin-top:16px;}
  .btn{
    padding:12px 16px; font-weight:800; border-radius:12px; border:1px solid var(--border); cursor:pointer; flex:1 0 160px;
  }
  .primary{ color:#fff; background: linear-gradient(90deg, var(--accent1), var(--accent2)); border:none;}
  .ghost{ color:var(--muted); background: transparent;}
  .note{margin-top:10px; padding:10px 12px; border:1px dashed var(--border); border-radius:12px; color:var(--muted); display:none;}
  .results{display:none}
  .list{
    border:1px dashed var(--border); border-radius:16px; overflow:hidden;
  }
  .rowline{display:grid; grid-template-columns:1fr 1fr; gap:0; border-top:1px dashed var(--border);}
  .rowline div{padding:14px 12px;}
  .rowline:first-child{border-top:none}
  footer{margin:28px auto 8px; text-align:center; color:var(--muted); font-size:13px;}
  .hidden{display:none !important;}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title" id="appTitle">حاسبة سعرات القط</div>
      <div class="lang-toggle">
        <button id="btnAr" class="active">ع</button>
        <button id="btnEn">E</button>
      </div>
    </header>

    <section class="card" id="sexCard">
      <h2 id="sexTitle">اختر الجنس للمتابعة</h2>
      <label for="sexSelect" id="sexLabel">جنس القط</label>
      <select id="sexSelect">
        <option value="" selected>—</option>
        <option value="male">ذكر</option>
        <option value="female">أنثى</option>
      </select>
    </section>

    <section class="card hidden" id="inputsCard">
      <h2 id="inputsTitle">المدخلات</h2>

      <div class="row">
        <div>
          <label id="weightLabel">الوزن الحالي (كجم)</label>
          <input id="currentWeight" type="number" inputmode="decimal" placeholder="مثال: 2.3" min="0" step="0.001">
        </div>
        <div>
          <label id="ageBaseLabel">الفئة العمرية/الحالة الأساسية</label>
          <select id="ageBase">
            <option value="kitten" selected>صغيرة (٢–٤ أشهر)</option>
            <option value="junior">متوسطة (٥–١٢ شهر)</option>
            <option value="adult">بالغة (أكبر من سنة)</option>
            <option value="neutered">معقمة</option>
          </select>
        </div>
      </div>

      <div class="row" id="rowWeek">
        <div>
          <label id="weekLabel">الأسبوع</label>
          <select id="kittenWeek">
            <!-- 5..16 -->
          </select>
        </div>
        <div>
          <label id="activityLabel">النشاط</label>
          <select id="activity">
            <option value="low">نشاط قليل</option>
            <option value="mid">نشاط متوسط</option>
            <option value="high">نشاط عالي</option>
          </select>
        </div>
      </div>

      <div class="chips" id="pregLactGroup">
        <label class="hidden" id="pregNote" style="margin:0;"></label>
        <div class="chip" id="chipPreg">
          <input type="checkbox" id="pregnant">
          <span id="pregnantTxt">حامل</span>
        </div>
        <div class="chip" id="chipLact">
          <input type="checkbox" id="lactating">
          <span id="lactatingTxt">مرضعة</span>
        </div>
      </div>

      <div class="row" id="rowPregDetails">
        <div id="prePregWrap">
          <label id="prePregLabel">الوزن قبل الحمل (كجم)</label>
          <input id="prePregWeight" type="number" inputmode="decimal" placeholder="مثال: ٣٫٨" min="0" step="0.001">
        </div>
        <div>
          <label id="pregWeekLabel">أسبوع الحمل</label>
          <select id="pregWeek">
            <option>١–٤</option>
            <option>٥</option>
            <option>٦</option>
            <option>٧</option>
            <option>٨</option>
            <option>٩</option>
          </select>
        </div>
      </div>

      <div class="row" id="rowLactDetails">
        <div>
          <label id="kittenCountLabel">عدد الصغار</label>
          <select id="kittenCount">
            <option value="2plus">≥٢</option>
            <option value="3to4">٣–٤</option>
            <option value="5to6">٥–٦</option>
            <option value="7plus">٧≤</option>
          </select>
        </div>
        <div>
          <label id="lactWeekLabel">أسبوع الإرضاع</label>
          <select id="lactWeek">
            <option>الأسبوع 1</option>
            <option>الأسبوع 2</option>
            <option>الأسبوع 3</option>
            <option>الأسبوع 4</option>
            <option>الأسبوع 5</option>
            <option>الأسبوع 6</option>
            <option>الأسبوع 7</option>
            <option>الأسبوع 8</option>
            <option>الأسبوع 9</option>
            <option>الأسبوع 10</option>
          </select>
        </div>
      </div>

      <div class="btns">
        <button id="calcBtn" class="btn primary">احسب النتائج</button>
        <button id="resetBtn" class="btn ghost">إعادة ضبط</button>
      </div>
      <div class="note" id="errorNote"></div>
    </section>

    <section class="card results" id="resultsCard">
      <h2 id="resultsTitle">النتائج</h2>
      <div class="list">
        <div class="rowline"><div id="dailyCaloriesLabel">السعرات اليومية</div><div><span id="outCal">0</span> kcal</div></div>
        <div class="rowline"><div id="mealsLabel">عدد الوجبات</div><div id="outMeals">0</div></div>
        <div class="rowline"><div id="freeLabel">الأكل الحر</div><div id="outFree">بدون أكل حر</div></div>
      </div>
    </section>

    <footer>© ALBRAICHY 2025 — ALL RIGHTS RESERVED</footer>
  </div>

<script>
// Fill week select 5..16
const weekSel = document.getElementById('kittenWeek');
for(let w=5; w<=16; w++){
  const op = document.createElement('option');
  op.value = String(w);
  op.textContent = 'الأسبوع ' + w;
  if(w===16) op.selected = true;
  weekSel.appendChild(op);
}

const els = {
  sexCard: document.getElementById('sexCard'),
  inputsCard: document.getElementById('inputsCard'),
  resultsCard: document.getElementById('resultsCard'),
  sex: document.getElementById('sexSelect'),
  ageBase: document.getElementById('ageBase'),
  weekWrap: document.getElementById('rowWeek'),
  week: document.getElementById('kittenWeek'),
  chipPreg: document.getElementById('chipPreg'),
  chipLact: document.getElementById('chipLact'),
  pregnant: document.getElementById('pregnant'),
  lactating: document.getElementById('lactating'),
  rowPreg: document.getElementById('rowPregDetails'),
  rowLact: document.getElementById('rowLactDetails'),
  prePreg: document.getElementById('prePregWeight'),
  error: document.getElementById('errorNote'),
  calc: document.getElementById('calcBtn'),
  reset: document.getElementById('resetBtn'),
  outCal: document.getElementById('outCal'),
  outMeals: document.getElementById('outMeals'),
  outFree: document.getElementById('outFree'),
};

function show(el){ el.classList.remove('hidden'); }
function hide(el){ el.classList.add('hidden'); }

function setPregLactVisibility(){
  // Default hide details rows
  hide(els.rowPreg); hide(els.rowLact);
  // Rules based on sex + age + week
  const sex = els.sex.value;
  const base = els.ageBase.value;
  const week = parseInt(els.week.value || '0', 10);

  // By default show both chips
  show(els.chipPreg); show(els.chipLact);

  if(sex === 'male'){
    // Male: no pregnancy/lactation at all
    hide(els.chipPreg); hide(els.chipLact);
    els.pregnant.checked = false; els.lactating.checked = false;
    return;
  }

  if(base === 'kitten'){
    // Kittens: only week 16 may get pregnant (realistic edge), never lactating
    if(week < 16){
      hide(els.chipPreg); hide(els.chipLact);
      els.pregnant.checked = false; els.lactating.checked = false;
    }else{
      // week 16 exactly: allow Pregnant only
      show(els.chipPreg);
      hide(els.chipLact);
      els.lactating.checked = false;
    }
  }else if(base === 'neutered'){
    // Neutered: none
    hide(els.chipPreg); hide(els.chipLact);
    els.pregnant.checked = false; els.lactating.checked = false;
  }else{
    // junior/adult: show both chips
    show(els.chipPreg); show(els.chipLact);
  }

  // Details visibility
  if(els.pregnant.checked && !els.chipPreg.classList.contains('hidden')) show(els.rowPreg); 
  if(els.lactating.checked && !els.chipLact.classList.contains('hidden')) show(els.rowLact);
}

function gateBySex(){
  // Gate UI until sex is chosen
  if(!els.sex.value){ hide(els.inputsCard); hide(els.resultsCard); return; }
  show(els.inputsCard);
  setPregLactVisibility();
}
els.sex.addEventListener('change', gateBySex);
els.ageBase.addEventListener('change', ()=>{ setPregLactVisibility(); });
els.week.addEventListener('change', ()=>{ setPregLactVisibility(); });
els.pregnant.addEventListener('change', ()=>{ setPregLactVisibility(); });
els.lactating.addEventListener('change', ()=>{ setPregLactVisibility(); });

// Simple placeholder calculation (kept since user's math logic exists elsewhere)
// Here we just ensure UI doesn't blank and outputs something reasonable.
function calc(){
  els.error.style.display='none';
  // Validate pre-pregnancy when pregnant visible/checked
  if(!els.chipPreg.classList.contains('hidden') && els.pregnant.checked){
    const v = parseFloat(els.prePreg.value);
    if(!(v>0)){
      els.error.textContent = (document.documentElement.lang==='ar'?'الوزن قبل الحمل مطلوب عند اختيار (حامل).':'Pre-pregnancy weight is required when Pregnant is selected.');
      els.error.style.display='block';
      return;
    }
  }
  // Fake math just for UI demo
  const w = parseFloat(document.getElementById('currentWeight').value||0);
  const base = els.ageBase.value;
  let A = 1.0;
  if(base==='kitten'){ A = 2.1; if(parseInt(els.week.value,10)>=16) A = 2.0; }
  if(base==='junior'){ A = 1.8; }
  if(base==='adult'){ A = 1.1; }
  if(base==='neutered'){ A = .95; }
  if(els.pregnant.checked) A += .2;
  if(els.lactating.checked) A += .8;
  const cal = Math.round((100 * Math.pow(w,0.67) * A) * 100)/100;
  const meals = cal? (cal<200?5: cal<260?4:3) : 0;
  const free = (els.lactating.checked || (base==='kitten' && parseInt(els.week.value,10)<=14)) ? 'مع أكل حر — المطلوب تقريباً 4.0 غ' : 'بدون أكل حر';
  els.outCal.textContent = cal.toFixed(2);
  els.outMeals.textContent = meals;
  els.outFree.textContent = document.documentElement.lang==='ar'? free : (free.startsWith('مع')?'Free-feeding — about 4.0 g':'No free-feeding');
  show(els.resultsCard);
}
els.calc.addEventListener('click', calc);
els.reset.addEventListener('click', ()=>{ 
  document.getElementById('currentWeight').value='';
  els.pregnant.checked=false; els.lactating.checked=false;
  els.prePreg.value='';
  hide(els.resultsCard); els.error.style.display='none';
  setPregLactVisibility();
});

// Language toggle
function setLang(lang){
  const ar = (lang==='ar');
  document.documentElement.lang = ar?'ar':'en';
  document.documentElement.dir = ar?'rtl':'ltr';
  document.getElementById('btnAr').classList.toggle('active', ar);
  document.getElementById('btnEn').classList.toggle('active', !ar);
  // Labels
  const T = ar? {
    app:'حاسبة سعرات القط', sexTitle:'اختر الجنس للمتابعة', sex:'جنس القط', inputs:'المدخلات',
    weight:'الوزن الحالي (كجم)', base:'الفئة العمرية/الحالة الأساسية', week:'الأسبوع',
    activity:'النشاط', preg:'حامل', lact:'مرضعة', pre:'الوزن قبل الحمل (كجم)',
    pregWeek:'أسبوع الحمل', kittens:'عدد الصغار', lactWeek:'أسبوع الإرضاع',
    calc:'احسب النتائج', reset:'إعادة ضبط', results:'النتائج',
    daily:'السعرات اليومية', meals:'عدد الوجبات', free:'الأكل الحر'
  } : {
    app:'Cat Calorie Calculator', sexTitle:'Select Sex to continue', sex:'Sex',
    inputs:'Inputs', weight:'Current Weight (kg)', base:'Age / Base Condition', week:'Week',
    activity:'Activity', preg:'Pregnant', lact:'Lactating', pre:'Pre-pregnancy Weight (kg)',
    pregWeek:'Pregnancy Week', kittens:'Kitten Count', lactWeek:'Lactation Week',
    calc:'Calculate', reset:'Reset', results:'Results',
    daily:'Daily Calories', meals:'Meals per Day', free:'Free-feeding'
  };
  document.getElementById('appTitle').textContent = T.app;
  document.getElementById('sexTitle').textContent = T.sexTitle;
  document.getElementById('sexLabel').textContent = T.sex;
  document.getElementById('inputsTitle').textContent = T.inputs;
  document.getElementById('weightLabel').textContent = T.weight;
  document.getElementById('ageBaseLabel').textContent = T.base;
  document.getElementById('weekLabel').textContent = T.week;
  document.getElementById('activityLabel').textContent = T.activity;
  document.getElementById('pregnantTxt').textContent = T.preg;
  document.getElementById('lactatingTxt').textContent = T.lact;
  document.getElementById('prePregLabel').textContent = T.pre;
  document.getElementById('pregWeekLabel').textContent = T.pregWeek;
  document.getElementById('kittenCountLabel').textContent = T.kittens;
  document.getElementById('lactWeekLabel').textContent = T.lactWeek;
  document.getElementById('calcBtn').textContent = T.calc;
  document.getElementById('resetBtn').textContent = T.reset;
  document.getElementById('resultsTitle').textContent = T.results;
  document.getElementById('dailyCaloriesLabel').textContent = T.daily;
  document.getElementById('mealsLabel').textContent = T.meals;
  document.getElementById('freeLabel').textContent = T.free;

  // Options text for selects
  const base = document.getElementById('ageBase');
  base.options[0].text = ar?'صغيرة (٢–٤ أشهر)':'Kitten (2–4 mo)';
  base.options[1].text = ar?'متوسطة (٥–١٢ شهر)':'Junior (5–12 mo)';
  base.options[2].text = ar?'بالغة (أكبر من سنة)':'Adult (>1 yr)';
  base.options[3].text = ar?'معقمة':'Neutered';

  const act = document.getElementById('activity');
  act.options[0].text = ar?'نشاط قليل':'Low Activity';
  act.options[1].text = ar?'نشاط متوسط':'Moderate Activity';
  act.options[2].text = ar?'نشاط عالي':'High Activity';

  // Week select items already Arabic. If English, rewrite:
  if(!ar){
    [...weekSel.options].forEach(o=>{
      o.textContent = 'Week ' + o.value;
    });
    // Lactation week
    [...document.getElementById('lactWeek').options].forEach((o,i)=>{
      if(i===0) o.textContent='Week 1'; else o.textContent = 'Week ' + (i+0);
    });
    // Sex options
    const sexSel = document.getElementById('sexSelect');
    sexSel.options[1].text='Male'; sexSel.options[2].text='Female'; sexSel.options[0].text='—';
  }else{
    // restore Arabic text
    [...weekSel.options].forEach(o=>{ o.textContent = 'الأسبوع ' + o.value; });
    [...document.getElementById('lactWeek').options].forEach((o,i)=>{
      o.textContent = 'الأسبوع ' + (i+1);
    });
    const sexSel = document.getElementById('sexSelect');
    sexSel.options[1].text='ذكر'; sexSel.options[2].text='أنثى'; sexSel.options[0].text='—';
  }
}
document.getElementById('btnAr').addEventListener('click', ()=>setLang('ar'));
document.getElementById('btnEn').addEventListener('click', ()=>setLang('en'));

// Init
gateBySex();
setLang('ar');
</script>
</body>
</html>
